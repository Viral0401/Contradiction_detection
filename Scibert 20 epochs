{"metadata":{"kaggle":{"accelerator":"nvidiaTeslaT4","dataSources":[{"sourceId":8663191,"sourceType":"datasetVersion","datasetId":5190813},{"sourceId":8675894,"sourceType":"datasetVersion","datasetId":5200340}],"dockerImageVersionId":30733,"isInternetEnabled":true,"language":"python","sourceType":"notebook","isGpuEnabled":true},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.10.13"},"papermill":{"default_parameters":{},"duration":20361.962237,"end_time":"2024-06-07T22:21:50.350744","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2024-06-07T16:42:28.388507","version":"2.5.0"},"widgets":{"application/vnd.jupyter.widget-state+json":{"state":{"00bfd5fa78d241258329061b5d6ee522":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1039d7baee464afb9c9d5bb002b4ccc3":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"294343b0c07843a7ba0a8d92a55a0318":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b2a483cdf964466a9afb7fd5ee07db9e","placeholder":"​","style":"IPY_MODEL_f66e4f9a90744c47b79913c4937c8ed8","value":"config.json: 100%"}},"345717e626214adba90f5a59e7e0f53a":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"391ca9fd94b241a08499dffb85c7d35c":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3954d5c755d24ce2810fb1061d8f5dd3":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e9734fdb61d34528a1b7e37557d2cd83","placeholder":"​","style":"IPY_MODEL_aa85f7b511a047f6b17e7aa26682c1c1","value":" 442M/442M [00:03&lt;00:00, 123MB/s]"}},"426cfacdbd0e44baa909d152c720235b":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4aa63217c4a44c5d8657d2c588bdef9c":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_79d2bd99b7f04b5789c90b4ea45435f3","IPY_MODEL_7324789824704c559614bbf85416520c","IPY_MODEL_3954d5c755d24ce2810fb1061d8f5dd3"],"layout":"IPY_MODEL_af8880b27688411f982eb5e227f1aaab"}},"547b34ed7d4548ebb237865f42d97387":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"618b3c055a0d46fda1eae848816b72ef":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_a5853bf7eb72499e9250b39304ccd75d","max":227845,"min":0,"orientation":"horizontal","style":"IPY_MODEL_6a8cbb80210f47d8990f1559a0c44dc3","value":227845}},"6a8cbb80210f47d8990f1559a0c44dc3":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"6fe1c7e5e83044f286dab6c94183b33a":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"703fd8c9264c48b186a677b732ea3f95":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"7324789824704c559614bbf85416520c":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_a0d208ff3cf243049539143bcfe6364b","max":442221694,"min":0,"orientation":"horizontal","style":"IPY_MODEL_703fd8c9264c48b186a677b732ea3f95","value":442221694}},"79d2bd99b7f04b5789c90b4ea45435f3":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_00bfd5fa78d241258329061b5d6ee522","placeholder":"​","style":"IPY_MODEL_901cf05140fb42f98799df32d2ed197b","value":"pytorch_model.bin: 100%"}},"84abfeefa1f043098065df3dc6db175d":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"901cf05140fb42f98799df32d2ed197b":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"91eadfbbdb3744a39008be02d48fef85":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"944075b9ba264e0b9e1d8c1991be76a5":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a962a6f41cb641cda251be18e25bc48a","placeholder":"​","style":"IPY_MODEL_91eadfbbdb3744a39008be02d48fef85","value":"vocab.txt: 100%"}},"a0d208ff3cf243049539143bcfe6364b":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a52f97bf9e5848378d772fe3ca8e50c8":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_345717e626214adba90f5a59e7e0f53a","max":385,"min":0,"orientation":"horizontal","style":"IPY_MODEL_547b34ed7d4548ebb237865f42d97387","value":385}},"a5853bf7eb72499e9250b39304ccd75d":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a962a6f41cb641cda251be18e25bc48a":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"aa85f7b511a047f6b17e7aa26682c1c1":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"af8880b27688411f982eb5e227f1aaab":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b0e50329bc244528804bc4e908fcadf0":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_84abfeefa1f043098065df3dc6db175d","placeholder":"​","style":"IPY_MODEL_6fe1c7e5e83044f286dab6c94183b33a","value":" 228k/228k [00:00&lt;00:00, 4.45MB/s]"}},"b2a483cdf964466a9afb7fd5ee07db9e":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b32297bd037546789433712b67670ec1":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_294343b0c07843a7ba0a8d92a55a0318","IPY_MODEL_a52f97bf9e5848378d772fe3ca8e50c8","IPY_MODEL_c195dee741bf4558a7f69647686c4e83"],"layout":"IPY_MODEL_426cfacdbd0e44baa909d152c720235b"}},"c195dee741bf4558a7f69647686c4e83":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c271250d1ddb44bc810c492124c6d32f","placeholder":"​","style":"IPY_MODEL_391ca9fd94b241a08499dffb85c7d35c","value":" 385/385 [00:00&lt;00:00, 36.2kB/s]"}},"c271250d1ddb44bc810c492124c6d32f":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e9734fdb61d34528a1b7e37557d2cd83":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ef22e2992c424e83bc9931a534ac336c":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_944075b9ba264e0b9e1d8c1991be76a5","IPY_MODEL_618b3c055a0d46fda1eae848816b72ef","IPY_MODEL_b0e50329bc244528804bc4e908fcadf0"],"layout":"IPY_MODEL_1039d7baee464afb9c9d5bb002b4ccc3"}},"f66e4f9a90744c47b79913c4937c8ed8":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}},"version_major":2,"version_minor":0}}},"nbformat_minor":4,"nbformat":4,"cells":[{"cell_type":"code","source":"!pip install keras_preprocessing","metadata":{"_cell_guid":"b1076dfc-b9ad-4769-8c92-a6c4dae69d19","_uuid":"8f2839f25d086af736a60e9eeb907d3b93b6e0e5","papermill":{"duration":14.252008,"end_time":"2024-06-07T16:42:45.505909","exception":false,"start_time":"2024-06-07T16:42:31.253901","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-12T17:15:55.641506Z","iopub.execute_input":"2024-06-12T17:15:55.642545Z","iopub.status.idle":"2024-06-12T17:16:09.250993Z","shell.execute_reply.started":"2024-06-12T17:15:55.642506Z","shell.execute_reply":"2024-06-12T17:16:09.249865Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"import numpy as np\nimport pandas as pd\nfrom sklearn.utils import class_weight","metadata":{"papermill":{"duration":1.756412,"end_time":"2024-06-07T16:42:47.275538","exception":false,"start_time":"2024-06-07T16:42:45.519126","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-12T17:16:09.253018Z","iopub.execute_input":"2024-06-12T17:16:09.253338Z","iopub.status.idle":"2024-06-12T17:16:09.258271Z","shell.execute_reply.started":"2024-06-12T17:16:09.253310Z","shell.execute_reply":"2024-06-12T17:16:09.257350Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"df = pd.read_csv(\"/kaggle/input/viraldalal/Sdata_annotated.csv\")","metadata":{"papermill":{"duration":0.383761,"end_time":"2024-06-07T16:42:47.667494","exception":false,"start_time":"2024-06-07T16:42:47.283733","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-12T17:16:09.259667Z","iopub.execute_input":"2024-06-12T17:16:09.260098Z","iopub.status.idle":"2024-06-12T17:16:09.519647Z","shell.execute_reply.started":"2024-06-12T17:16:09.260067Z","shell.execute_reply":"2024-06-12T17:16:09.518647Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"df.head()","metadata":{"papermill":{"duration":0.034929,"end_time":"2024-06-07T16:42:47.710878","exception":false,"start_time":"2024-06-07T16:42:47.675949","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-12T17:16:09.522812Z","iopub.execute_input":"2024-06-12T17:16:09.523545Z","iopub.status.idle":"2024-06-12T17:16:09.540184Z","shell.execute_reply.started":"2024-06-12T17:16:09.523514Z","shell.execute_reply":"2024-06-12T17:16:09.539085Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"df.drop(['Unnamed: 0.1', 'Unnamed: 0', 'paper_id', 'pair_id', 'aspect', 'line_pair'], inplace = True, axis=1)","metadata":{"papermill":{"duration":0.022163,"end_time":"2024-06-07T16:42:47.742138","exception":false,"start_time":"2024-06-07T16:42:47.719975","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-12T17:16:09.541302Z","iopub.execute_input":"2024-06-12T17:16:09.541589Z","iopub.status.idle":"2024-06-12T17:16:09.552369Z","shell.execute_reply.started":"2024-06-12T17:16:09.541565Z","shell.execute_reply":"2024-06-12T17:16:09.551598Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"df['label'] = df['label'].replace({'c': 1, 'n': 0})","metadata":{"papermill":{"duration":0.048456,"end_time":"2024-06-07T16:42:47.799047","exception":false,"start_time":"2024-06-07T16:42:47.750591","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-12T17:16:09.553564Z","iopub.execute_input":"2024-06-12T17:16:09.553969Z","iopub.status.idle":"2024-06-12T17:16:09.594059Z","shell.execute_reply.started":"2024-06-12T17:16:09.553934Z","shell.execute_reply":"2024-06-12T17:16:09.593166Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"df.head()","metadata":{"papermill":{"duration":0.023845,"end_time":"2024-06-07T16:42:47.832606","exception":false,"start_time":"2024-06-07T16:42:47.808761","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-12T17:16:09.595355Z","iopub.execute_input":"2024-06-12T17:16:09.595716Z","iopub.status.idle":"2024-06-12T17:16:09.607031Z","shell.execute_reply.started":"2024-06-12T17:16:09.595683Z","shell.execute_reply":"2024-06-12T17:16:09.606111Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"count_0 = df[df['label'] == 0].shape[0]\n\ncount_1 = df[df['label'] == 1].shape[0]\n\nprint(\"Number of rows where 'label' is 0:\", count_0)\nprint(\"Number of rows where 'label' is 1:\", count_1)","metadata":{"papermill":{"duration":0.026991,"end_time":"2024-06-07T16:42:47.869836","exception":false,"start_time":"2024-06-07T16:42:47.842845","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-12T17:16:09.608657Z","iopub.execute_input":"2024-06-12T17:16:09.608979Z","iopub.status.idle":"2024-06-12T17:16:09.624173Z","shell.execute_reply.started":"2024-06-12T17:16:09.608952Z","shell.execute_reply":"2024-06-12T17:16:09.623293Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"df.shape","metadata":{"papermill":{"duration":0.017593,"end_time":"2024-06-07T16:42:47.897724","exception":false,"start_time":"2024-06-07T16:42:47.880131","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-12T17:16:09.625582Z","iopub.execute_input":"2024-06-12T17:16:09.626343Z","iopub.status.idle":"2024-06-12T17:16:09.633939Z","shell.execute_reply.started":"2024-06-12T17:16:09.626309Z","shell.execute_reply":"2024-06-12T17:16:09.633109Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"# from sklearn.feature_extraction.text import TfidfVectorizer\n# from imblearn.over_sampling import SMOTE\n# from collections import Counter\n\n\n# tfidf_vectorizer_hypothesis = TfidfVectorizer(max_features=10000)\n# X_hypothesis = tfidf_vectorizer_hypothesis.fit_transform(df['hypothesis'])\n\n# # TF-IDF vectorization for 'premise' column\n# tfidf_vectorizer_premise = TfidfVectorizer(max_features=10000)\n# X_premise = tfidf_vectorizer_premise.fit_transform(df['premise'])\n\n# y = df['label']\n\n\n# smote_hypothesis = SMOTE(random_state=42)\n# X_hypothesis_resampled, y_resampled_hypothesis = smote_hypothesis.fit_resample(X_hypothesis, y)\n\n# smote_premise = SMOTE(random_state=42)\n# X_premise_resampled, y_resampled_premise = smote_premise.fit_resample(X_premise, y)\n\n# resampled_data = pd.DataFrame({\n#     'hypothesis': [vec.toarray().squeeze() for vec in X_hypothesis_resampled],\n#     'premise': [vec.toarray().squeeze() for vec in X_premise_resampled],\n#     'label': y_resampled_hypothesis\n# })\n\n# df = resampled_data\n# df.head()","metadata":{"execution":{"iopub.status.busy":"2024-06-12T17:16:09.637987Z","iopub.execute_input":"2024-06-12T17:16:09.638294Z","iopub.status.idle":"2024-06-12T17:16:09.643190Z","shell.execute_reply.started":"2024-06-12T17:16:09.638258Z","shell.execute_reply":"2024-06-12T17:16:09.642323Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"","metadata":{},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"X = df[['hypothesis', 'premise']]\ny = df['label']","metadata":{"execution":{"iopub.status.busy":"2024-06-12T17:16:09.644355Z","iopub.execute_input":"2024-06-12T17:16:09.644626Z","iopub.status.idle":"2024-06-12T17:16:09.661548Z","shell.execute_reply.started":"2024-06-12T17:16:09.644604Z","shell.execute_reply":"2024-06-12T17:16:09.660767Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"from imblearn.over_sampling import RandomOverSampler\nros = RandomOverSampler(random_state=42)\nX_resampled, y_resampled = ros.fit_resample(X, y)","metadata":{"execution":{"iopub.status.busy":"2024-06-12T17:16:09.662993Z","iopub.execute_input":"2024-06-12T17:16:09.663335Z","iopub.status.idle":"2024-06-12T17:16:09.693705Z","shell.execute_reply.started":"2024-06-12T17:16:09.663303Z","shell.execute_reply":"2024-06-12T17:16:09.692931Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"df = pd.DataFrame({\n    'hypothesis': X_resampled['hypothesis'],\n    'premise': X_resampled['premise'],\n    'label': y_resampled\n})","metadata":{"execution":{"iopub.status.busy":"2024-06-12T17:16:09.694948Z","iopub.execute_input":"2024-06-12T17:16:09.695290Z","iopub.status.idle":"2024-06-12T17:16:09.701337Z","shell.execute_reply.started":"2024-06-12T17:16:09.695259Z","shell.execute_reply":"2024-06-12T17:16:09.700364Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"df.shape","metadata":{"execution":{"iopub.status.busy":"2024-06-12T17:16:09.702477Z","iopub.execute_input":"2024-06-12T17:16:09.702843Z","iopub.status.idle":"2024-06-12T17:16:09.713434Z","shell.execute_reply.started":"2024-06-12T17:16:09.702812Z","shell.execute_reply":"2024-06-12T17:16:09.712600Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"df.head()","metadata":{"execution":{"iopub.status.busy":"2024-06-12T17:16:09.714766Z","iopub.execute_input":"2024-06-12T17:16:09.715058Z","iopub.status.idle":"2024-06-12T17:16:09.730345Z","shell.execute_reply.started":"2024-06-12T17:16:09.715036Z","shell.execute_reply":"2024-06-12T17:16:09.729367Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"count_0 = df[df['label'] == 0].shape[0]\n\ncount_1 = df[df['label'] == 1].shape[0]\n\nprint(\"Number of rows where 'label' is 0:\", count_0)\nprint(\"Number of rows where 'label' is 1:\", count_1)","metadata":{"execution":{"iopub.status.busy":"2024-06-12T17:16:09.731629Z","iopub.execute_input":"2024-06-12T17:16:09.731984Z","iopub.status.idle":"2024-06-12T17:16:09.752681Z","shell.execute_reply.started":"2024-06-12T17:16:09.731957Z","shell.execute_reply":"2024-06-12T17:16:09.751852Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"","metadata":{},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"from sklearn.model_selection import train_test_split","metadata":{"papermill":{"duration":0.11527,"end_time":"2024-06-07T16:42:48.022056","exception":false,"start_time":"2024-06-07T16:42:47.906786","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-12T17:16:09.753826Z","iopub.execute_input":"2024-06-12T17:16:09.754188Z","iopub.status.idle":"2024-06-12T17:16:09.759058Z","shell.execute_reply.started":"2024-06-12T17:16:09.754161Z","shell.execute_reply":"2024-06-12T17:16:09.757936Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"X = df[['hypothesis','premise']]\ny = df['label']","metadata":{"papermill":{"duration":0.019697,"end_time":"2024-06-07T16:42:48.050929","exception":false,"start_time":"2024-06-07T16:42:48.031232","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-12T17:16:09.760202Z","iopub.execute_input":"2024-06-12T17:16:09.760883Z","iopub.status.idle":"2024-06-12T17:16:09.774343Z","shell.execute_reply.started":"2024-06-12T17:16:09.760853Z","shell.execute_reply":"2024-06-12T17:16:09.773467Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)","metadata":{"papermill":{"duration":0.022471,"end_time":"2024-06-07T16:42:48.081979","exception":false,"start_time":"2024-06-07T16:42:48.059508","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-12T17:16:09.775601Z","iopub.execute_input":"2024-06-12T17:16:09.775910Z","iopub.status.idle":"2024-06-12T17:16:09.794410Z","shell.execute_reply.started":"2024-06-12T17:16:09.775885Z","shell.execute_reply":"2024-06-12T17:16:09.793474Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"from transformers import AutoTokenizer, TFAutoModel\nimport tensorflow as tf","metadata":{"papermill":{"duration":16.248947,"end_time":"2024-06-07T16:43:04.339680","exception":false,"start_time":"2024-06-07T16:42:48.090733","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-12T17:16:09.795676Z","iopub.execute_input":"2024-06-12T17:16:09.796046Z","iopub.status.idle":"2024-06-12T17:16:09.800606Z","shell.execute_reply.started":"2024-06-12T17:16:09.796013Z","shell.execute_reply":"2024-06-12T17:16:09.799675Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"tokenizer = AutoTokenizer.from_pretrained(\"allenai/scibert_scivocab_uncased\")\nscibert_model = TFAutoModel.from_pretrained(\"allenai/scibert_scivocab_uncased\", from_pt=True)","metadata":{"papermill":{"duration":8.492362,"end_time":"2024-06-07T16:43:12.841101","exception":false,"start_time":"2024-06-07T16:43:04.348739","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-12T17:16:09.801963Z","iopub.execute_input":"2024-06-12T17:16:09.802585Z","iopub.status.idle":"2024-06-12T17:16:11.711083Z","shell.execute_reply.started":"2024-06-12T17:16:09.802549Z","shell.execute_reply":"2024-06-12T17:16:11.710172Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"MAX_LEN = 128\ndef encode_texts(texts):\n    return tokenizer(\n        texts.tolist(), padding=True, truncation=True, max_length=MAX_LEN, return_tensors='tf'\n    )","metadata":{"papermill":{"duration":0.019489,"end_time":"2024-06-07T16:43:12.871379","exception":false,"start_time":"2024-06-07T16:43:12.851890","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-12T17:16:11.712303Z","iopub.execute_input":"2024-06-12T17:16:11.712599Z","iopub.status.idle":"2024-06-12T17:16:11.717451Z","shell.execute_reply.started":"2024-06-12T17:16:11.712573Z","shell.execute_reply":"2024-06-12T17:16:11.716562Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"train_hypotheses_enc = encode_texts(X_train['hypothesis'])\ntrain_premises_enc = encode_texts(X_train['premise'])\ntest_hypotheses_enc = encode_texts(X_test['hypothesis'])\ntest_premises_enc = encode_texts(X_test['premise'])","metadata":{"papermill":{"duration":10.020868,"end_time":"2024-06-07T16:43:22.902606","exception":false,"start_time":"2024-06-07T16:43:12.881738","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-12T17:16:11.718619Z","iopub.execute_input":"2024-06-12T17:16:11.718919Z","iopub.status.idle":"2024-06-12T17:16:30.022806Z","shell.execute_reply.started":"2024-06-12T17:16:11.718894Z","shell.execute_reply":"2024-06-12T17:16:30.021843Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"train_dataset = tf.data.Dataset.from_tensor_slices(\n    ((train_hypotheses_enc['input_ids'], train_hypotheses_enc['attention_mask'],\n      train_premises_enc['input_ids'], train_premises_enc['attention_mask']),\n     y_train)\n).shuffle(len(X_train)).batch(16)\n\ntest_dataset = tf.data.Dataset.from_tensor_slices(\n    ((test_hypotheses_enc['input_ids'], test_hypotheses_enc['attention_mask'],\n      test_premises_enc['input_ids'], test_premises_enc['attention_mask']),\n     y_test)\n).batch(16)","metadata":{"papermill":{"duration":0.035946,"end_time":"2024-06-07T16:43:22.948976","exception":false,"start_time":"2024-06-07T16:43:22.913030","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-12T17:16:30.024215Z","iopub.execute_input":"2024-06-12T17:16:30.024501Z","iopub.status.idle":"2024-06-12T17:16:30.055859Z","shell.execute_reply.started":"2024-06-12T17:16:30.024477Z","shell.execute_reply":"2024-06-12T17:16:30.055108Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"class AttentionLayer(tf.keras.layers.Layer):\n    def __init__(self, **kwargs):\n        super(AttentionLayer, self).__init__(**kwargs)\n\n    def build(self, input_shape):\n        self.W = self.add_weight(name=\"att_weight\", shape=(input_shape[-1],), initializer=\"random_normal\")\n        super(AttentionLayer, self).build(input_shape)\n\n    def call(self, x):\n        e = tf.keras.backend.tanh(tf.tensordot(x, self.W, axes=(2, 0)))\n        a = tf.keras.backend.softmax(e)\n        output = x * tf.expand_dims(a, -1)\n        return tf.keras.backend.sum(output, axis=1)\n\ndef build_model():\n    input_ids_hyp = tf.keras.Input(shape=(MAX_LEN,), dtype=tf.int32, name='input_ids_hyp')\n    attention_mask_hyp = tf.keras.Input(shape=(MAX_LEN,), dtype=tf.int32, name='attention_mask_hyp')\n    input_ids_prem = tf.keras.Input(shape=(MAX_LEN,), dtype=tf.int32, name='input_ids_prem')\n    attention_mask_prem = tf.keras.Input(shape=(MAX_LEN,), dtype=tf.int32, name='attention_mask_prem')\n\n    scibert_output_hyp = scibert_model(input_ids=input_ids_hyp, attention_mask=attention_mask_hyp)[0]\n    scibert_output_prem = scibert_model(input_ids=input_ids_prem, attention_mask=attention_mask_prem)[0]\n\n    lstm_hyp = tf.keras.layers.Bidirectional(tf.keras.layers.LSTM(64, return_sequences=True))(scibert_output_hyp)\n    lstm_prem = tf.keras.layers.Bidirectional(tf.keras.layers.LSTM(64, return_sequences=True))(scibert_output_prem)\n\n    att_hyp = AttentionLayer()(lstm_hyp)\n    att_prem = AttentionLayer()(lstm_prem)\n\n    concatenated = tf.keras.layers.Concatenate()([att_hyp, att_prem])\n\n    dense = tf.keras.layers.Dense(64, activation='relu')(concatenated)\n    output = tf.keras.layers.Dense(1, activation='sigmoid')(dense)\n\n    model = tf.keras.Model(inputs=[input_ids_hyp, attention_mask_hyp, input_ids_prem, attention_mask_prem], outputs=output)\n\n    model.compile(optimizer=tf.keras.optimizers.Adam(learning_rate=1e-5),\n                  loss='binary_crossentropy',\n                  metrics=['accuracy'])\n    \n    return model","metadata":{"papermill":{"duration":0.113578,"end_time":"2024-06-07T16:43:23.072907","exception":false,"start_time":"2024-06-07T16:43:22.959329","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-12T17:16:30.057244Z","iopub.execute_input":"2024-06-12T17:16:30.057526Z","iopub.status.idle":"2024-06-12T17:16:30.072379Z","shell.execute_reply.started":"2024-06-12T17:16:30.057501Z","shell.execute_reply":"2024-06-12T17:16:30.071434Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"model = build_model()\nmodel.summary()","metadata":{"papermill":{"duration":30.940701,"end_time":"2024-06-07T16:43:54.023724","exception":false,"start_time":"2024-06-07T16:43:23.083023","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-12T17:16:30.073600Z","iopub.execute_input":"2024-06-12T17:16:30.073916Z","iopub.status.idle":"2024-06-12T17:16:50.317600Z","shell.execute_reply.started":"2024-06-12T17:16:30.073890Z","shell.execute_reply":"2024-06-12T17:16:50.316691Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"tf.keras.utils.plot_model(model,to_file='multi-task_model.png', show_shapes=True)","metadata":{"papermill":{"duration":0.790423,"end_time":"2024-06-07T16:43:54.827839","exception":false,"start_time":"2024-06-07T16:43:54.037416","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-12T17:17:16.530824Z","iopub.execute_input":"2024-06-12T17:17:16.531175Z","iopub.status.idle":"2024-06-12T17:17:16.720988Z","shell.execute_reply.started":"2024-06-12T17:17:16.531146Z","shell.execute_reply":"2024-06-12T17:17:16.720052Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"class_weights = class_weight.compute_class_weight('balanced', classes=np.unique(y_train), y=y_train)\nclass_weights = {i : class_weights[i] for i in range(len(class_weights))}","metadata":{"papermill":{"duration":0.036614,"end_time":"2024-06-07T16:43:54.880750","exception":false,"start_time":"2024-06-07T16:43:54.844136","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-12T17:17:17.566642Z","iopub.execute_input":"2024-06-12T17:17:17.567469Z","iopub.status.idle":"2024-06-12T17:17:17.582094Z","shell.execute_reply.started":"2024-06-12T17:17:17.567436Z","shell.execute_reply":"2024-06-12T17:17:17.581293Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"import keras\nimport tensorflow as tf\nmy_callbacks = [\n    tf.keras.callbacks.EarlyStopping(patience=5),\n    tf.keras.callbacks.ModelCheckpoint(filepath='model.{epoch:02d}-{val_loss:.2f}.keras', save_best_only=True, monitor='val_loss', mode='min'),\n    tf.keras.callbacks.TensorBoard(log_dir='./logs')\n]","metadata":{"execution":{"iopub.status.busy":"2024-06-12T17:17:19.497831Z","iopub.execute_input":"2024-06-12T17:17:19.498659Z","iopub.status.idle":"2024-06-12T17:17:19.503804Z","shell.execute_reply.started":"2024-06-12T17:17:19.498626Z","shell.execute_reply":"2024-06-12T17:17:19.502848Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"model.fit(train_dataset, epochs=20, validation_data=test_dataset, class_weight=class_weights, callbacks=my_callbacks)","metadata":{"papermill":{"duration":19978.781596,"end_time":"2024-06-07T22:16:53.677516","exception":false,"start_time":"2024-06-07T16:43:54.895920","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-12T17:17:34.239312Z","iopub.execute_input":"2024-06-12T17:17:34.240188Z","iopub.status.idle":"2024-06-12T17:24:48.672734Z","shell.execute_reply.started":"2024-06-12T17:17:34.240154Z","shell.execute_reply":"2024-06-12T17:24:48.671281Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"y_pred = model.predict(test_dataset)\ny_pred = np.round(y_pred).flatten()","metadata":{"papermill":{"duration":277.574659,"end_time":"2024-06-07T22:21:33.052349","exception":false,"start_time":"2024-06-07T22:16:55.477690","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-11T17:50:19.284834Z","iopub.execute_input":"2024-06-11T17:50:19.285118Z","iopub.status.idle":"2024-06-11T17:54:50.834088Z","shell.execute_reply.started":"2024-06-11T17:50:19.285095Z","shell.execute_reply":"2024-06-11T17:54:50.833205Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"from sklearn.metrics import f1_score, accuracy_score, precision_score, recall_score, confusion_matrix\nimport matplotlib.pyplot as plt\nimport seaborn as sns","metadata":{"papermill":{"duration":1.9768,"end_time":"2024-06-07T22:21:36.819564","exception":false,"start_time":"2024-06-07T22:21:34.842764","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-11T17:54:50.835270Z","iopub.execute_input":"2024-06-11T17:54:50.835589Z","iopub.status.idle":"2024-06-11T17:54:50.969309Z","shell.execute_reply.started":"2024-06-11T17:54:50.835563Z","shell.execute_reply":"2024-06-11T17:54:50.968576Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"f1 = f1_score(y_test, y_pred)\naccuracy = accuracy_score(y_test, y_pred)\nprecision = precision_score(y_test, y_pred)\nrecall = recall_score(y_test, y_pred)\n\nprint(f\"Test F1 Score: {f1}\")\nprint(f\"Test Accuracy: {accuracy}\")\nprint(f\"Test Precision: {precision}\")\nprint(f\"Test Recall: {recall}\")","metadata":{"papermill":{"duration":1.953961,"end_time":"2024-06-07T22:21:40.689934","exception":false,"start_time":"2024-06-07T22:21:38.735973","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-11T17:54:50.970367Z","iopub.execute_input":"2024-06-11T17:54:50.970616Z","iopub.status.idle":"2024-06-11T17:54:51.007711Z","shell.execute_reply.started":"2024-06-11T17:54:50.970592Z","shell.execute_reply":"2024-06-11T17:54:51.006856Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"cm = confusion_matrix(y_test, y_pred)\n\nplt.figure(figsize=(8, 6))\nsns.heatmap(cm, annot=True, fmt='d', cmap='Blues', xticklabels=['Non-Contradicting', 'Contradicting'], yticklabels=['Non-Contradicting', 'Contradicting'])\nplt.xlabel('Predicted')\nplt.ylabel('True')\nplt.title('Confusion Matrix')\nplt.show()","metadata":{"papermill":{"duration":2.11264,"end_time":"2024-06-07T22:21:44.661624","exception":false,"start_time":"2024-06-07T22:21:42.548984","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-06-11T17:54:51.008695Z","iopub.execute_input":"2024-06-11T17:54:51.008946Z","iopub.status.idle":"2024-06-11T17:54:51.350454Z","shell.execute_reply.started":"2024-06-11T17:54:51.008924Z","shell.execute_reply":"2024-06-11T17:54:51.349550Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"","metadata":{},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"def predict_contradiction(hypothesis, premise, model):\n    # Encode hypothesis\n    hyp_enc = tokenizer(\n        hypothesis,\n        padding='max_length',\n        truncation=True,\n        max_length=128,\n        return_tensors='tf'\n    )\n\n    # Encode premise\n    prem_enc = tokenizer(\n        premise,\n        padding='max_length',\n        truncation=True,\n        max_length=128,\n        return_tensors='tf'\n    )\n\n    # Prepare the inputs dictionary for the model\n    inputs = {\n        'input_ids_hyp': hyp_enc['input_ids'],\n        'attention_mask_hyp': hyp_enc['attention_mask'],\n        'input_ids_prem': prem_enc['input_ids'],\n        'attention_mask_prem': prem_enc['attention_mask']\n    }\n\n    # Get the prediction from the model\n    prediction = model.predict(inputs)\n\n    # Convert prediction to binary outcome\n    result = 'contradicting' if prediction[0][0] > 0.5 else 'non-contradicting'\n    return result\n\n# Test the function with example inputs\nhypothesis = \"2 .this paper is not very easy to follow .\"\npremise = \"this paper is well written and the information is very intensive whereby closely related works are well covered .\"\n\n# Get the prediction\nresult = predict_contradiction(hypothesis, premise, model)\nprint(f\"The prediction is: {result}\")","metadata":{"execution":{"iopub.status.busy":"2024-06-11T18:43:29.572532Z","iopub.execute_input":"2024-06-11T18:43:29.572940Z","iopub.status.idle":"2024-06-11T18:43:29.720286Z","shell.execute_reply.started":"2024-06-11T18:43:29.572910Z","shell.execute_reply":"2024-06-11T18:43:29.719363Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"def predict_contradiction(hypothesis, premise, model):\n    # Encode hypothesis\n    hyp_enc = tokenizer(\n        hypothesis,\n        padding='max_length',\n        truncation=True,\n        max_length=128,\n        return_tensors='tf'\n    )\n\n    # Encode premise\n    prem_enc = tokenizer(\n        premise,\n        padding='max_length',\n        truncation=True,\n        max_length=128,\n        return_tensors='tf'\n    )\n\n    # Prepare the inputs dictionary for the model\n    inputs = {\n        'input_ids_hyp': hyp_enc['input_ids'],\n        'attention_mask_hyp': hyp_enc['attention_mask'],\n        'input_ids_prem': prem_enc['input_ids'],\n        'attention_mask_prem': prem_enc['attention_mask']\n    }\n\n    # Get the prediction from the model\n    prediction = model.predict(inputs)\n\n    # Convert prediction to binary outcome\n    result = 'contradicting' if prediction[0][0] > 0.5 else 'non-contradicting'\n    return result\n\n# Test the function with example inputs\nhypothesis = \"further the paper makes several misleading claims .\"\npremise = \"the paper is rather well written but it strongly lacks precision about the proposed method .\"\n\n# Get the prediction\nresult = predict_contradiction(hypothesis, premise, model)\nprint(f\"The prediction is: {result}\")","metadata":{"execution":{"iopub.status.busy":"2024-06-11T18:44:00.422975Z","iopub.execute_input":"2024-06-11T18:44:00.423321Z","iopub.status.idle":"2024-06-11T18:44:00.580324Z","shell.execute_reply.started":"2024-06-11T18:44:00.423293Z","shell.execute_reply":"2024-06-11T18:44:00.579409Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"import pickle\nfrom transformers import TFAutoModel, AutoTokenizer\n\n# Initialize the tokenizer and model\ntokenizer = AutoTokenizer.from_pretrained(\"allenai/scibert_scivocab_uncased\")\nscibert_model = TFAutoModel.from_pretrained(\"allenai/scibert_scivocab_uncased\", from_pt=True)\n\n\n# Function to save the model weights to a pickle file\ndef save_model_weights_to_pickle(model, file_path):\n    # Get the model weights\n    model_weights = model.get_weights()\n    \n    # Save the model weights to a pickle file\n    with open(file_path, 'wb') as file:\n        pickle.dump(model_weights, file)\n    print(f\"Model weights saved to {file_path}\")\n\n# File path to save the model weights\nweights_file_path = 'model_weights.pkl'\n\n# Save the model weights\nsave_model_weights_to_pickle(weights_file_path)","metadata":{"execution":{"iopub.status.busy":"2024-06-11T18:54:28.438664Z","iopub.execute_input":"2024-06-11T18:54:28.439074Z","iopub.status.idle":"2024-06-11T18:54:31.324432Z","shell.execute_reply.started":"2024-06-11T18:54:28.439042Z","shell.execute_reply":"2024-06-11T18:54:31.323466Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":"","metadata":{},"execution_count":null,"outputs":[]}]}